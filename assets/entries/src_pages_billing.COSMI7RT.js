import{r as h,u as P,j as a,i as b}from"../chunks/chunk-DYanOIQ-.js";import{C as T}from"../chunks/chunk-DEthOLBT.js";/* empty css                      *//* empty css                      */import"../chunks/chunk-DbGXuVtK.js";/* empty css                      *//* empty css                      *//* empty css                      *//* empty css                      *//* empty css                      *//* empty css                      *//* empty css                      *//* empty css                      *//* empty css                      *//* empty css                      *//* empty css                      *//* empty css                      *//* empty css                      *//* empty css                      *//* empty css                      *//* empty css                      *//* empty css                      *//* empty css                      *//* empty css                      *//* empty css                      *//* empty css                      *//* empty css                      *//* empty css                      *//* empty css                      *//* empty css                      *//* empty css                      *//* empty css                      *//* empty css                      */var g="https://js.stripe.com/v3",C=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/;var z=function(){for(var e=document.querySelectorAll('script[src^="'.concat(g,'"]')),r=0;r<e.length;r++){var t=e[r];if(C.test(t.src))return t}return null},w=function(e){var r="",t=document.createElement("script");t.src="".concat(g).concat(r);var o=document.head||document.body;if(!o)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return o.appendChild(t),t},A=function(e,r){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"5.6.0",startTime:r})},l=null,c=null,m=null,L=function(e){return function(){e(new Error("Failed to load Stripe.js"))}},R=function(e,r){return function(){window.Stripe?e(window.Stripe):r(new Error("Stripe.js not available"))}},U=function(e){return l!==null?l:(l=new Promise(function(r,t){if(typeof window>"u"||typeof document>"u"){r(null);return}if(window.Stripe){r(window.Stripe);return}try{var o=z();if(!(o&&e)){if(!o)o=w(e);else if(o&&m!==null&&c!==null){var i;o.removeEventListener("load",m),o.removeEventListener("error",c),(i=o.parentNode)===null||i===void 0||i.removeChild(o),o=w(e)}}m=R(r,t),c=L(t),o.addEventListener("load",m),o.addEventListener("error",c)}catch(u){t(u);return}}),l.catch(function(r){return l=null,Promise.reject(r)}))},D=function(e,r,t){if(e===null)return null;var o=e.apply(void 0,r);return A(o,t),o},d,y=!1,x=function(){return d||(d=U(null).catch(function(e){return d=null,Promise.reject(e)}),d)};Promise.resolve().then(function(){return x()}).catch(function(n){y||console.warn(n)});var O=function(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];y=!0;var o=Date.now();return x().then(function(i){return D(i,r,o)})};const k=O("pk_test_51Qn6p4RoO280mx7jwfqkc7gummGs3CyKz5DPUgDVvzgh0faWbQCd6xZszEMfZbw88OsvZnM7EUd5msyNSslt3xu4000T32JdeY"),I=n=>{const[e,r]=h.useState(""),[t,o]=h.useState(!1),[i,u]=h.useState(""),{ensureValidToken:E,user:f}=P(),j=async()=>{o(!0),u("");try{console.log("Starting payment request with amount:",e);const s=await E();if(!s)throw new Error("Unauthorized: Failed to get authentication token.");const v=await fetch("https://api.cheap.chat/createPaymentSession",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`,Origin:window.location.origin},body:JSON.stringify({amount:Number(e),userId:(f==null?void 0:f.userId)||"unknown"})}),p=await v.json();if(console.log("Response from API:",p),!v.ok||!p.id)throw new Error(p.error||"Failed to create checkout session");const S=await k;if(!S)throw new Error("Stripe failed to initialize");await S.redirectToCheckout({sessionId:p.id})}catch(s){console.error("Payment error:",s),u(s.message),o(!1)}};return a.jsx(T,{...n,pageContent:a.jsxs("div",{style:{textAlign:"center",padding:"20px"},children:[a.jsx("h1",{children:"Buy CheapChat Credits"}),a.jsx("p",{children:"Enter the amount (in USD) you want to purchase:"}),a.jsx("input",{type:"number",placeholder:"Enter amount",value:e,onChange:s=>r(s.target.value),style:{padding:"10px",margin:"10px",fontSize:"16px",width:"200px"}}),a.jsx("br",{}),a.jsx("button",{onClick:j,disabled:!e||t,style:{backgroundColor:t?"#ccc":"#007bff",color:"white",padding:"10px 20px",fontSize:"18px",border:"none",cursor:t?"not-allowed":"pointer",borderRadius:"5px"},children:t?"Processing...":"Proceed to Payment"}),i&&a.jsx("p",{style:{color:"red",marginTop:"10px"},children:i})]})})},V=Object.freeze(Object.defineProperty({__proto__:null,default:I},Symbol.toStringTag,{value:"Module"})),Se={isClientRuntimeLoaded:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:!0}},onBeforeRenderEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},dataEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},hydrationCanBeAborted:{type:"standard",definedAtData:{filePathToShowToUser:"/renderer/+config.js",fileExportPathToShowToUser:["default","hydrationCanBeAborted"]},valueSerialized:{type:"js-serialized",value:!0}},onRenderClient:{type:"standard",definedAtData:{filePathToShowToUser:"/renderer/+onRenderClient.jsx",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:b}},Page:{type:"standard",definedAtData:{filePathToShowToUser:"/src/pages/billing/+Page.jsx",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:V}}};export{Se as configValuesSerialized};
