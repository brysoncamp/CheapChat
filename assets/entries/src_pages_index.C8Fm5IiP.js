import{r as o,j as e,f as A,i as I}from"../chunks/chunk-gX9am_Dg.js";/* empty css                      *//* empty css                      *//* empty css                      *//* empty css                      *//* empty css                      *//* empty css                      *//* empty css                      *//* empty css                      *//* empty css                      */const z="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M6%2012H18M12%206V18'%20stroke='%23000000'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",U="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M20%207V8.2C20%209.88016%2020%2010.7202%2019.673%2011.362C19.3854%2011.9265%2018.9265%2012.3854%2018.362%2012.673C17.7202%2013%2016.8802%2013%2015.2%2013H4M4%2013L8%209M4%2013L8%2017'%20stroke='%23000000'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",D=o.forwardRef(({value:r,onChange:a,onSend:s},n)=>{o.useEffect(()=>{const t=n.current,i=()=>{t&&(t.style.height="auto",t.style.height=`${t.scrollHeight}px`)};return t.addEventListener("input",i),i(),()=>{t.removeEventListener("input",i)}},[n]);const c=t=>{t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),s())};return e.jsx("textarea",{ref:n,rows:"1",className:"input-text",placeholder:"Chat with GPT-4o",value:r,onChange:a,onKeyDown:c})}),R=({icon:r,altText:a,onClick:s,extraClass:n=""})=>e.jsx("button",{className:`action-button ${n}`,onClick:s,children:e.jsx("img",{className:"icon",src:r,alt:a})}),P=({inputValue:r,setInputValue:a,onSend:s})=>{const n=o.useRef(null),c=o.useRef(null);return o.useEffect(()=>{const t=i=>{!i.target.closest("button")&&c.current&&c.current.focus()};return n.current.addEventListener("click",t),()=>n.current.removeEventListener("click",t)},[]),e.jsxs("div",{className:"input-container",ref:n,children:[e.jsx(R,{icon:z,altText:"plus",extraClass:"add-button"}),e.jsx(D,{value:r,onChange:t=>a(t.target.value),onSend:s,ref:c}),e.jsx(R,{icon:U,altText:"send",extraClass:`send-button ${r?"send-active":""}`,onClick:s})]})},V="wss://ws.cheap.chat",W=o.forwardRef((r,a)=>{const[s,n]=o.useState(null),[c,t]=o.useState([]),[i,T]=o.useState(null),[w,m]=o.useState(""),h=o.useRef("");o.useEffect(()=>((async()=>{var d,f,j,k,y;try{const g=await A(),b=(f=(d=g.tokens)==null?void 0:d.idToken)==null?void 0:f.toString(),C=(y=(k=(j=g.tokens)==null?void 0:j.idToken)==null?void 0:k.payload)==null?void 0:y.sub;if(!b||!C){console.error("❌ No token or userId found, user must re-authenticate.");return}const S=`${C}-${Math.random().toString(36).substr(2,9)}`;T(S);const u=new WebSocket(`${V}?token=${b}&sessionId=${S}`);u.onopen=()=>{console.log("✅ WebSocket Connected with sessionId:",S),n(u)},u.onmessage=v=>{try{const p=JSON.parse(v.data);if(console.log("📩 Message Received:",p),p.text&&m(x=>(h.current=x+p.text,h.current)),p.done){console.log("✅ AI Response Complete - Moving to Messages List");const x=h.current.trim();x&&t(E=>[...E,{sender:"AI",text:x}]),m(""),h.current=""}}catch(p){console.error("❌ Error parsing message:",p)}},u.onerror=v=>console.error("❌ WebSocket Error:",v),u.onclose=()=>console.log("🔴 WebSocket Disconnected"),n(u)}catch(g){console.error("❌ WebSocket Auth Error:",g)}})(),()=>{s&&s.close()}),[]);const M=l=>{if(s&&l.trim()){const d={action:"openai",message:l,sessionId:i};console.log("📤 Sending Message:",d),s.send(JSON.stringify(d)),t(f=>[...f,{sender:"User",text:l}]),m(""),h.current=""}};return o.useImperativeHandle(a,()=>({sendMessage:M})),e.jsxs("div",{children:[e.jsx("h2",{children:"WebSocket Chat"}),e.jsxs("p",{children:["Session ID: ",i]}),e.jsxs("div",{children:[c.map((l,d)=>e.jsxs("p",{children:[e.jsxs("strong",{children:[l.sender,":"]})," ",l.text]},d)),w&&e.jsxs("p",{children:[e.jsx("strong",{children:"AI (typing...):"})," ",w]})," "]})]})}),L=()=>{const[r,a]=o.useState(""),s=o.useRef(null),n=()=>{r.trim()&&(s.current&&s.current.sendMessage(r),a(""))};return e.jsxs("div",{className:"page",children:[e.jsxs("div",{className:"body",children:[e.jsx(W,{ref:s})," "]}),e.jsx(P,{inputValue:r,setInputValue:a,onSend:n})]})},N=Object.freeze(Object.defineProperty({__proto__:null,default:L},Symbol.toStringTag,{value:"Module"})),Q={isClientRuntimeLoaded:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:!0}},onBeforeRenderEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},dataEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},hydrationCanBeAborted:{type:"standard",definedAtData:{filePathToShowToUser:"/renderer/+config.js",fileExportPathToShowToUser:["default","hydrationCanBeAborted"]},valueSerialized:{type:"js-serialized",value:!0}},onRenderClient:{type:"standard",definedAtData:{filePathToShowToUser:"/renderer/+onRenderClient.jsx",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:I}},Page:{type:"standard",definedAtData:{filePathToShowToUser:"/src/pages/index/+Page.jsx",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:N}}};export{Q as configValuesSerialized};
